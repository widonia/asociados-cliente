tinymce.PluginManager.add("noneditable",function(e){function t(e){var t;if(1===e.nodeType){if(t=e.getAttribute(c),t&&"inherit"!==t)return t;if(t=e.contentEditable,"inherit"!==t)return t}return null}function n(e){for(var n;e;){if(n=t(e))return"false"===n?e:null;e=e.parentNode}}function r(){function r(e){for(;e;){if(e.id===m)return e;e=e.parentNode}}function a(e){var t;if(e)for(t=new f(e,e),e=t.current();e;e=t.next())if(3===e.nodeType)return e}function i(n,r){var a,i;return"false"===t(n)&&c.isBlock(n)?void u.select(n):(i=c.createRng(),"true"===t(n)&&(n.firstChild||n.appendChild(e.getDoc().createTextNode("Â ")),n=n.firstChild,r=!0),a=c.create("span",{id:m,"data-mce-bogus":!0},g),r?n.parentNode.insertBefore(a,n):c.insertAfter(a,n),i.setStart(a.firstChild,1),i.collapse(!0),u.setRng(i),a)}function o(e){var t,n,r;if(e)t=u.getRng(!0),t.setStartBefore(e),t.setEndBefore(e),n=a(e),n&&n.nodeValue.charAt(0)==g&&(n=n.deleteData(0,1)),c.remove(e,!0),u.setRng(t);else for(;(e=c.get(m))&&e!==r;)n=a(e),n&&n.nodeValue.charAt(0)==g&&(n=n.deleteData(0,1)),c.remove(e,!0),r=e}function l(){function e(e,n){var r,a,i,o,l;if(r=s.startContainer,a=s.startOffset,3==r.nodeType){if(l=r.nodeValue.length,a>0&&l>a||(n?a==l:0===a))return}else{if(!(a<r.childNodes.length))return n?null:e;var c=!n&&a>0?a-1:a;r=r.childNodes[c],r.hasChildNodes()&&(r=r.firstChild)}for(i=new f(r,e);o=i[n?"prev":"next"]();){if(3===o.nodeType&&o.nodeValue.length>0)return;if("true"===t(o))return o}return e}var r,a,l,s,c;o(),l=u.isCollapsed(),r=n(u.getStart()),a=n(u.getEnd()),(r||a)&&(s=u.getRng(!0),l?(r=r||a,(c=e(r,!0))?i(c,!0):(c=e(r,!1))?i(c,!1):u.select(r)):(s=u.getRng(!0),r&&s.setStartBefore(r),a&&s.setEndAfter(a),u.setRng(s)))}function s(a){function i(e,t){for(;e=e[t?"previousSibling":"nextSibling"];)if(3!==e.nodeType||e.nodeValue.length>0)return e}function s(e,t){u.select(e),u.collapse(t)}function m(a){function i(e){for(var t=s;t;){if(t===e)return;t=t.parentNode}c.remove(e),l()}function o(){var r,o,l=e.schema.getNonEmptyElements();for(o=new tinymce.dom.TreeWalker(s,e.getBody());(r=a?o.prev():o.next())&&!l[r.nodeName.toLowerCase()]&&!(3===r.nodeType&&tinymce.trim(r.nodeValue).length>0);)if("false"===t(r))return i(r),!0;return n(r)?!0:!1}var f,s,d,m;if(u.isCollapsed()){if(f=u.getRng(!0),s=f.startContainer,d=f.startOffset,s=r(s)||s,m=n(s))return i(m),!1;if(3==s.nodeType&&(a?d>0:d<s.nodeValue.length))return!0;if(1==s.nodeType&&(s=s.childNodes[d]||s),o())return!1}return!0}var g,p,v,E,T=a.keyCode;l(),v=u.getStart(),E=u.getEnd(),g=n(v)||n(E);var h=e.selection.getNode(),b=T==d.LEFT||T==d.RIGHT||T==d.UP||T==d.DOWN,C=T==d.LEFT||T==d.UP;if(g&&(112>T||T>124)&&T!=d.DELETE&&T!=d.BACKSPACE){if((tinymce.isMac?a.metaKey:a.ctrlKey)&&(67==T||88==T||86==T))return;if(a.preventDefault(),b)if(e.dom.isBlock(g)){var y=C?g.previousSibling:g.nextSibling;if(!y||y&&"false"===t(y)){var N=c.create("p",null,"&nbsp;");N.className="mceTmpParagraph";var S=C?g:y;S&&S.parentNode?S.parentNode.insertBefore(N,S):y||C||g.parentNode.appendChild(N),y=N}var A=new f(y,y),B=C?A.prev():A.next();s(B,!C)}else s(g,C)}else if(b||T==d.BACKSPACE||T==d.DELETE){if(p=r(v)){if(T==d.LEFT||T==d.BACKSPACE)if(g=i(p,!0),g&&"false"===t(g)){if(a.preventDefault(),T!=d.LEFT)return void c.remove(g);s(g,!0)}else o(p);if(T==d.RIGHT||T==d.DELETE)if(g=i(p,!0),g&&"false"===t(g)){if(a.preventDefault(),T!=d.RIGHT)return void c.remove(g);s(g,!1)}else o(p)}else{if(b&&h&&-1!==h.className.indexOf("mceTmpParagraph")&&h[C?"previousSibling":"nextSibling"]){var P=h[C?"previousSibling":"nextSibling"];"&nbsp;"===h.innerHTML||""===h.innerHTML||" "===h.innerHTML?c.remove(h):h.className=h.className.replace("mceTmpParagraph",""),s(P,!C)}var x=u.getRng(!0),L=x.endContainer;if(c.isBlock(L)&&c.isBlock(L.nextSibling)&&1==x.endOffset&&T==d.DELETE&&(g=n(L.nextSibling)),g&&(T==d.DELETE||T==d.BACKSPACE)&&c.isBlock(g))return a.preventDefault(),void c.remove(g)}if((T==d.BACKSPACE||T==d.DELETE)&&!m(T==d.BACKSPACE))return a.preventDefault(),!1}}var c=e.dom,u=e.selection,m="mce_noneditablecaret",g="\ufeff";e.on("mousedown",function(n){var r=e.selection.getNode();r&&-1!==r.className.indexOf("mceTmpParagraph")&&r!==n.target&&("&nbsp;"===r.innerHTML||""===r.innerHTML||" "===r.innerHTML?c.remove(r):r.className=r.className.replace("mceTmpParagraph","")),"false"===t(r)&&r==n.target&&l()}),e.on("mouseup",l),e.on("keydown",s)}function a(t){var n=l.length,r=t.content,a=tinymce.trim(o);if("raw"!=t.format){for(;n--;)r=r.replace(l[n],function(t){var n=arguments,i=n[n.length-2];return i>0&&'"'==r.charAt(i-1)?t:'<span class="'+a+'" data-mce-content="'+e.dom.encode(n[0])+'">'+e.dom.encode("string"==typeof n[1]?n[1]:n[0])+"</span>"});t.content=r}}var i,o,l,f=tinymce.dom.TreeWalker,s="contenteditable",c="data-mce-"+s,d=tinymce.util.VK;i=" "+tinymce.trim(e.getParam("noneditable_editable_class","mceEditable"))+" ",o=" "+tinymce.trim(e.getParam("noneditable_noneditable_class","mceNonEditable"))+" ",l=e.getParam("noneditable_regexp"),l&&!l.length&&(l=[l]),e.on("PreInit",function(){r(),l&&e.on("BeforeSetContent",a),e.parser.addAttributeFilter("class",function(e){for(var t,n,r=e.length;r--;)n=e[r],t=" "+n.attr("class")+" ",-1!==t.indexOf(i)?n.attr(c,"true"):-1!==t.indexOf(o)&&n.attr(c,"false")}),e.serializer.addAttributeFilter(c,function(e){for(var t,n=e.length;n--;)t=e[n],l&&t.attr("data-mce-content")?(t.name="#text",t.type=3,t.raw=!0,t.value=t.attr("data-mce-content")):(t.attr(s,null),t.attr(c,null))}),e.parser.addAttributeFilter(s,function(e){for(var t,n=e.length;n--;)t=e[n],t.attr(c,t.attr(s)),t.attr(s,null)})}),e.on("drop",function(e){n(e.target)&&e.preventDefault()})});