!function(){var e=angular.module("angularFileUpload",[]);e.service("$upload",["$http","$q","$timeout",function(e,t,n){function r(r){r.method=r.method||"POST",r.headers=r.headers||{},r.transformRequest=r.transformRequest||function(t,n){return window.ArrayBuffer&&t instanceof window.ArrayBuffer?t:e.defaults.transformRequest[0](t,n)};var a=t.defer();window.XMLHttpRequest.__isShim&&(r.headers.__setXHR_=function(){return function(e){e&&(r.__XHR=e,r.xhrFn&&r.xhrFn(e),e.upload.addEventListener("progress",function(e){a.notify(e)},!1),e.upload.addEventListener("load",function(e){e.lengthComputable&&a.notify(e)},!1))}}),e(r).then(function(e){a.resolve(e)},function(e){a.reject(e)},function(e){a.notify(e)});var i=a.promise;return i.success=function(e){return i.then(function(t){e(t.data,t.status,t.headers,r)}),i},i.error=function(e){return i.then(null,function(t){e(t.data,t.status,t.headers,r)}),i},i.progress=function(e){return i.then(null,null,function(t){e(t)}),i},i.abort=function(){return r.__XHR&&n(function(){r.__XHR.abort()}),i},i.xhr=function(e){return r.xhrFn=function(t){return function(){t&&t.apply(i,arguments),e.apply(i,arguments)}}(r.xhrFn),i},i}this.upload=function(t){t.headers=t.headers||{},t.headers["Content-Type"]=void 0,t.transformRequest=t.transformRequest||e.defaults.transformRequest;var n=new FormData,a=t.transformRequest,i=t.data;return t.transformRequest=function(e,n){if(i)if(t.formDataAppender)for(var r in i){var o=i[r];t.formDataAppender(e,r,o)}else for(var r in i){var o=i[r];if("function"==typeof a)o=a(o,n);else for(var s=0;s<a.length;s++){var l=a[s];"function"==typeof l&&(o=l(o,n))}e.append(r,o)}if(null!=t.file){var u=t.fileFormDataName||"file";if("[object Array]"===Object.prototype.toString.call(t.file))for(var f="[object String]"===Object.prototype.toString.call(u),s=0;s<t.file.length;s++)e.append(f?u:u[s],t.file[s],t.fileName&&t.fileName[s]||t.file[s].name);else e.append(u,t.file,t.fileName||t.file.name)}return e},t.data=n,r(t)},this.http=function(e){return r(e)}}]),e.directive("ngFileSelect",["$parse","$timeout",function(e,t){return function(n,r,a){var i=e(a.ngFileSelect);if("input"!==r[0].tagName.toLowerCase()||"file"!==(r.attr("type")&&r.attr("type").toLowerCase())){for(var o=angular.element('<input type="file">'),s=0;s<r[0].attributes.length;s++)o.attr(r[0].attributes[s].name,r[0].attributes[s].value);r.attr("data-multiple")&&o.attr("multiple","true"),o.css("top",0).css("bottom",0).css("left",0).css("right",0).css("width","100%").css("opacity",0).css("position","absolute").css("filter","alpha(opacity=0)"),r.append(o),(""===r.css("position")||"static"===r.css("position"))&&r.css("position","relative"),r=o}r.bind("change",function(e){var r,a,o=[];if(r=e.__files_||e.target.files,null!=r)for(a=0;a<r.length;a++)o.push(r.item(a));t(function(){i(n,{$files:o,$event:e})})})}}]),e.directive("ngFileDropAvailable",["$parse","$timeout",function(e,t){return function(n,r,a){if("draggable"in document.createElement("span")){var i=e(a.ngFileDropAvailable);t(function(){i(n)})}}}]),e.directive("ngFileDrop",["$parse","$timeout","$location",function(e,t,n){return function(r,a,i){function o(e){return/^[\000-\177]*$/.test(e)}function s(e,r){var a=[],i=e.dataTransfer.items;if(i&&i.length>0&&i[0].webkitGetAsEntry&&"file"!=n.protocol())for(var s=0;s<i.length;s++){var u=i[s].webkitGetAsEntry();null!=u&&(o(u.name)?l(a,u):i[s].webkitGetAsEntry().isDirectory||a.push(i[s].getAsFile()))}else{var f=e.dataTransfer.files;if(null!=f)for(var s=0;s<f.length;s++)a.push(f.item(s))}!function d(e){t(function(){c?d(10):r(a)},e||0)}()}function l(e,t,n){if(null!=t)if(t.isDirectory){var r=t.createReader();c++,r.readEntries(function(r){for(var a=0;a<r.length;a++)l(e,r[a],(n?n:"")+t.name+"/");c--})}else c++,t.file(function(t){c--,t._relativePath=(n?n:"")+t.name,e.push(t)})}if("draggable"in document.createElement("span")){var u=null;a[0].addEventListener("dragover",function(n){if(n.stopPropagation(),n.preventDefault(),t.cancel(u),!a[0].__drag_over_class_)if(i.ngFileDragOverClass.search(/\) *$/)>-1){dragOverClassFn=e(i.ngFileDragOverClass);var o=dragOverClassFn(r,{$event:n});a[0].__drag_over_class_=o}else a[0].__drag_over_class_=i.ngFileDragOverClass||"dragover";a.addClass(a[0].__drag_over_class_)},!1),a[0].addEventListener("dragenter",function(e){e.stopPropagation(),e.preventDefault()},!1),a[0].addEventListener("dragleave",function(e){u=t(function(){a.removeClass(a[0].__drag_over_class_),a[0].__drag_over_class_=null},i.ngFileDragOverDelay||1)},!1);var f=e(i.ngFileDrop);a[0].addEventListener("drop",function(e){e.stopPropagation(),e.preventDefault(),a.removeClass(a[0].__drag_over_class_),a[0].__drag_over_class_=null,s(e,function(t){f(r,{$files:t,$event:e})})},!1);var c=0}}}])}();